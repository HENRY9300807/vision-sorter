name: Commit Message â†’ Issue

on:
  push:
    branches: [ "main" ]

permissions:
  issues: write
  contents: read

jobs:
  create-issues:
    runs-on: ubuntu-latest
    steps:
      - name: Create issues from commit messages
        uses: actions/github-script@v8
        with:
          script: |
            const commits = context.payload.commits || [];
            for (const c of commits) {
              const lines = (c.message || '').split('\n');
              for (const line of lines) {
                const m = line.match(/^ISSUE:\s*(.+)$/i);
                if (m) {
                  await github.rest.issues.create({
                    owner: context.repo.owner,
                    repo: context.repo.repo,
                    title: m[1].slice(0, 200),
                    body: `Auto-created from commit ${c.id}\n\n${c.message}`,
                    labels: ['auto']
                  });
                }
              }
            }

